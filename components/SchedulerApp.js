// updated logic with 1-day offset recalculation